(()=>{"use strict";function e(e){if(!e||e.dataset.initialized)return;const o=Array.from(e.querySelectorAll(".video-item")),a=e.dataset.layout||"featured-video",i="false"!==e.dataset.enableModal,l="false"!==e.dataset.enableLazyLoad;if(0!==o.length){if(l){const t=e.querySelectorAll("img[data-src]");t.length>0&&window.BlockIntersectionObserver.lazyLoadImages(t)}window.BlockIntersectionObserver.animateOnScroll(o,"animate-fade-in animate-scale-in"),o.forEach((o,l)=>{!function(e,o,a){const{layout:i,enableModal:l,block:n}=a,s=e.querySelector(".play-button, .video-play-overlay"),r=e.querySelector(".video-thumbnail, img"),d=function(e){const t=e.dataset;return{url:t.videoUrl||"",type:t.videoType||"upload",title:t.videoTitle||"",description:t.videoDescription||"",youtubeId:t.youtubeId||"",vimeoId:t.vimeoId||"",autoplay:"true"===t.autoplay,muted:"true"===t.muted,loop:"true"===t.loop,controls:"false"!==t.controls,poster:t.poster||""}}(e);if(!d.url&&!d.youtubeId&&!d.vimeoId)return;const c=new t(e,d,{enableModal:l,layout:i,index:o});s&&s.addEventListener("click",e=>{e.preventDefault(),c.play()}),r&&!s&&r.addEventListener("click",e=>{e.preventDefault(),c.play()}),e.setAttribute("tabindex","0"),e.setAttribute("role","button"),e.setAttribute("aria-label",`Play video: ${d.title}`),e.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),c.play())})}(o,l,{layout:a,enableModal:i,block:e})}),"playlist"===a&&o.length>1&&function(e,t){let o=0;const a=()=>{o=(o+1)%t.length;const e=t[o];e&&e.scrollIntoView({behavior:"smooth",block:"center"})};t.forEach((t,o)=>{const i=t.querySelector("video");i&&i.addEventListener("ended",()=>{"true"===e.dataset.autoplayNext&&setTimeout(a,1e3)})})}(e,o),"carousel"===a&&function(e,t){if(window.BlockTouchGestures){let o=0;const a=e=>{t.forEach((t,o)=>{t.style.display=o===e?"block":"none"}),o=e};window.BlockTouchGestures.create(e,{onSwipeLeft:()=>{const e=(o+1)%t.length;a(e)},onSwipeRight:()=>{const e=(o-1+t.length)%t.length;a(e)}}),a(0)}}(e,o),e.dataset.initialized="true"}}document.addEventListener("blockPresetsReady",function(t){"video-section"===t.detail.blockName&&document.querySelectorAll(".wp-block-tailwind-starter-video-section").forEach(e)});class t{constructor(e,t,o={}){this.element=e,this.videoData=t,this.options=o,this.isPlaying=!1,this.videoElement=null,this.modal=null}play(){this.options.enableModal?this.playInModal():this.playInline()}playInModal(){if(!window.BlockModalManager)return console.warn("Modal manager not available"),void this.playInline();const e=this.createVideoHTML();this.modal=window.BlockModalManager.create({title:this.videoData.title||"Video Player",content:e,size:"large",showCloseButton:!0,onShow:()=>{const e=this.modal.element.querySelector("video, iframe");e&&(this.setupVideoElement(e),this.startPlayback(e))},onHide:()=>{this.stopPlayback()}}),this.modal.show(),window.BlockAccessibility&&window.BlockAccessibility.announceToScreenReader(`Playing video: ${this.videoData.title}`)}playInline(){const e=this.element.querySelector(".video-container")||this.element,t=e.querySelector(".video-thumbnail, .video-placeholder");t&&(t.style.display="none");const o=this.createVideoHTML(),a=document.createElement("div");a.className="video-player-wrapper",a.innerHTML=o,e.appendChild(a);const i=a.querySelector("video, iframe");i&&(this.setupVideoElement(i),this.startPlayback(i))}createVideoHTML(){const{url:e,type:t,youtubeId:o,vimeoId:a,autoplay:i,muted:l,loop:n,controls:s,poster:r}=this.videoData;return"youtube"===t&&o?this.createYouTubeEmbed(o):"vimeo"===t&&a?this.createVimeoEmbed(a):e?`\n                <video \n                    class="w-full h-auto max-h-[70vh]"\n                    ${s?"controls":""}\n                    ${i?"autoplay":""}\n                    ${l?"muted":""}\n                    ${n?"loop":""}\n                    ${r?`poster="${r}"`:""}\n                    preload="metadata"\n                >\n                    <source src="${e}" type="video/mp4">\n                    <p>Your browser doesn't support HTML5 video. <a href="${e}">Download the video</a> instead.</p>\n                </video>\n            `:"<p>No video source available.</p>"}createYouTubeEmbed(e){return`\n            <iframe \n                class="w-full aspect-video"\n                src="https://www.youtube.com/embed/${e}?autoplay=1&rel=0"\n                title="YouTube video player"\n                frameborder="0"\n                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"\n                allowfullscreen>\n            </iframe>\n        `}createVimeoEmbed(e){return`\n            <iframe \n                class="w-full aspect-video"\n                src="https://player.vimeo.com/video/${e}?autoplay=1"\n                title="Vimeo video player"\n                frameborder="0"\n                allow="autoplay; fullscreen; picture-in-picture"\n                allowfullscreen>\n            </iframe>\n        `}setupVideoElement(e){this.videoElement=e,"VIDEO"===e.tagName&&e.addEventListener("keydown",e=>{switch(e.key){case" ":e.preventDefault(),this.togglePlayPause();break;case"ArrowLeft":e.preventDefault(),this.skipBackward();break;case"ArrowRight":e.preventDefault(),this.skipForward();break;case"f":e.preventDefault(),this.toggleFullscreen()}})}startPlayback(e){e&&"VIDEO"===e.tagName&&e.play().catch(e=>{console.warn("Video autoplay failed:",e)}),this.isPlaying=!0}stopPlayback(){this.videoElement&&"VIDEO"===this.videoElement.tagName&&this.videoElement.pause(),this.isPlaying=!1}togglePlayPause(){this.videoElement&&"VIDEO"===this.videoElement.tagName&&(this.videoElement.paused?this.videoElement.play():this.videoElement.pause())}skipBackward(e=10){this.videoElement&&"VIDEO"===this.videoElement.tagName&&(this.videoElement.currentTime=Math.max(0,this.videoElement.currentTime-e))}skipForward(e=10){this.videoElement&&"VIDEO"===this.videoElement.tagName&&(this.videoElement.currentTime+=e)}toggleFullscreen(){this.videoElement&&(document.fullscreenElement?document.exitFullscreen():this.videoElement.requestFullscreen().catch(e=>{console.warn("Fullscreen failed:",e)}))}}function o(){window.BlockAssetManager&&window.BlockAssetManager.registerBlockAssets("video-section",{presets:["modal-manager","animations","intersection-observer","touch-gestures"],priority:"normal"})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o()})();