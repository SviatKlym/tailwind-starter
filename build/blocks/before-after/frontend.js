(()=>{"use strict";class e{constructor(e){this.element=e,this.attributes=JSON.parse(e.dataset.attributes||"{}"),this.layout=this.attributes.layout||"slider-comparison",this.isDragging=!1,this.currentView="before",this.init()}init(){switch(this.layout){case"slider-comparison":this.initSliderComparison();break;case"toggle-switch":this.initToggleSwitch();break;case"overlay-fade":this.initOverlayFade();break;case"side-by-side":this.initSideBySide()}this.attributes.enableKeyboard&&this.initKeyboardNavigation(),this.attributes.enableFullscreen&&this.initFullscreen()}initSliderComparison(){const e=this.element.querySelector(".comparison-container");if(!e)return;const t=e.querySelector(".after-image"),i=e.querySelector(".slider-line"),s=e.querySelector(".slider-handle");if(!t||!i||!s)return;const n=this.attributes.sliderPosition||50;this.updateSliderPosition(n),s.addEventListener("mousedown",this.startDrag.bind(this)),document.addEventListener("mousemove",this.onDrag.bind(this)),document.addEventListener("mouseup",this.stopDrag.bind(this)),this.attributes.enableTouch&&(s.addEventListener("touchstart",this.startDrag.bind(this),{passive:!1}),document.addEventListener("touchmove",this.onDrag.bind(this),{passive:!1}),document.addEventListener("touchend",this.stopDrag.bind(this))),this.attributes.autoSlide&&this.startAutoSlide(),this.container=e,this.afterImage=t,this.sliderLine=i,this.sliderHandle=s}initToggleSwitch(){const e=this.element.querySelector(".comparison-container"),t=e?.querySelector(".toggle-button"),i=e?.querySelector(".before-image"),s=e?.querySelector(".after-image");t&&i&&s&&(t.addEventListener("click",()=>{this.currentView="before"===this.currentView?"after":"before","after"===this.currentView?(i.style.opacity="0",s.style.opacity="1",t.textContent="Show Before"):(i.style.opacity="1",s.style.opacity="0",t.textContent=this.attributes.toggleButtonText||"Toggle View"),this.announceChange(`Now showing ${this.currentView} image`)}),t.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t.click())}))}initOverlayFade(){const e=this.element.querySelector(".comparison-container");if(e&&this.attributes.enableTouch){let t=!1;e.addEventListener("click",()=>{const i=e.querySelector(".after-image");i&&(t=!t,t?(i.style.opacity="1",e.classList.add("revealed")):(i.style.opacity="0",e.classList.remove("revealed")),this.announceChange((t?"After":"Before")+" image is now visible"))})}}initSideBySide(){if("IntersectionObserver"in window){const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.add("animate-in")})},{threshold:.1});this.element.querySelectorAll(".before-section, .after-section").forEach(t=>{e.observe(t)})}}initKeyboardNavigation(){this.element.setAttribute("tabindex","0"),this.element.addEventListener("keydown",e=>{"slider-comparison"===this.layout?this.handleSliderKeyboard(e):"toggle-switch"===this.layout&&this.handleToggleKeyboard(e)})}handleSliderKeyboard(e){if(!this.container)return;let t=parseFloat(this.sliderLine?.style.left)||50;switch(e.key){case"ArrowLeft":e.preventDefault(),t=Math.max(0,t-5),this.updateSliderPosition(t),this.announceChange(`Slider at ${Math.round(t)}%`);break;case"ArrowRight":e.preventDefault(),t=Math.min(100,t+5),this.updateSliderPosition(t),this.announceChange(`Slider at ${Math.round(t)}%`);break;case"Home":e.preventDefault(),this.updateSliderPosition(0),this.announceChange("Slider at beginning");break;case"End":e.preventDefault(),this.updateSliderPosition(100),this.announceChange("Slider at end")}}handleToggleKeyboard(e){if("Enter"===e.key||" "===e.key){e.preventDefault();const t=this.element.querySelector(".toggle-button");t&&t.click()}}startDrag(e){e.preventDefault(),this.isDragging=!0,this.element.classList.add("dragging");const t=this.container.getBoundingClientRect();this.containerLeft=t.left,this.containerWidth=t.width}onDrag(e){if(!this.isDragging||!this.container)return;e.preventDefault();const t=(e.type.includes("touch")?e.touches[0].clientX:e.clientX)-this.containerLeft,i=Math.max(0,Math.min(100,t/this.containerWidth*100));this.updateSliderPosition(i)}stopDrag(){this.isDragging&&(this.isDragging=!1,this.element.classList.remove("dragging"))}updateSliderPosition(e){this.afterImage&&this.sliderLine&&this.sliderHandle&&(this.afterImage.style.clipPath=`polygon(${e}% 0%, 100% 0%, 100% 100%, ${e}% 100%)`,this.sliderLine.style.left=`${e}%`,this.sliderHandle.style.left=`${e}%`,this.attributes.sliderColor&&(this.sliderLine.style.backgroundColor=this.attributes.sliderColor,this.sliderHandle.style.backgroundColor=this.attributes.sliderColor),this.attributes.sliderThickness&&(this.sliderLine.style.width=`${this.attributes.sliderThickness}px`),this.attributes.handleSize&&(this.sliderHandle.style.width=`${this.attributes.handleSize}px`,this.sliderHandle.style.height=`${this.attributes.handleSize}px`),"square"===this.attributes.handleStyle&&(this.sliderHandle.style.borderRadius="4px"))}startAutoSlide(){const e=this.attributes.autoSlideDelay||3e3;let t=1,i=50;const s=setInterval(()=>{this.isDragging||(i+=2*t,(i>=100||i<=0)&&(t*=-1),this.updateSliderPosition(i))},e/50);this.element.addEventListener("mousedown",()=>{clearInterval(s)},{once:!0})}initFullscreen(){const e=this.element.querySelector(".fullscreen-button");e&&e.addEventListener("click",()=>{this.toggleFullscreen()})}toggleFullscreen(){document.fullscreenElement?document.exitFullscreen().then(()=>{this.element.classList.remove("fullscreen-mode")}):this.element.requestFullscreen().then(()=>{this.element.classList.add("fullscreen-mode")}).catch(e=>{console.log("Fullscreen error:",e)})}announceChange(e){const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="sr-only",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{document.body.removeChild(t)},1e3)}}function t(){document.querySelectorAll(".wp-block-tailwind-starter-before-after").forEach(t=>{t.dataset.initialized||(new e(t),t.dataset.initialized="true")})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t(),document.addEventListener("beforeAfterBlocksUpdate",t),window.BeforeAfterComparison=e,console.log("ðŸ“¸ Before After block frontend loaded")})();